name: Lint

on:
  push:
    branches: [ '**' ]
  pull_request:
    branches: [ '**' ]




jobs:
  run-linters:
    name: Run pylint
    runs-on: ubuntu-latest

    steps:
      - name: Check out Git repository
        uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: 3.8

      - name: Install Python dependencies
        run: pip install pylint==3.0.3

      - name: Run pylint and fail if score < 9.5
        run: |
          pylint_output=$(pylint $(git ls-files '*.py') --score=y | tee /dev/tty)
          score=$(echo "$pylint_output" | grep "Your code has been rated at" | awk '{print $7}' | cut -d'/' -f1)
          if (( $(echo "$score < 9.5" | bc -l) )); then
            echo "Pylint score is less than 9.5. Merge blocked."
            exit 1
          fi

